(function(){var t=[].slice,n=function(t,n){return function(){return t.apply(n,arguments)}},s=function(t,n){function s(){this.constructor=t}for(var i in n)r.call(n,i)&&(t[i]=n[i]);return s.prototype=n.prototype,t.prototype=new s,t.__super__=n.prototype,t},r={}.hasOwnProperty;!function(n,s){var r;return r=function(){function s(t,s){var r;this.options=n.extend({},this.defaults,s),this.$el=n(t),r=new Main(t,this.options.canvas,this.options.style),r.run()}return s.prototype.defaults={canvas:".visualizer",style:"circle"},n.fn.extend({audiViz:function(){var r,i;return i=arguments[0],r=2<=arguments.length?t.call(arguments,1):[],this.each(function(){var t,r;return t=n(this),r=t.data("audiViz"),r?void 0:t.data("audiViz",r=new s(this,i))})}}),s}()}(window.jQuery,window),this.Main=function(){function t(t,n,s){this.player=t,this.canvas=document.querySelector(n),this.style=s}return t.prototype.draw=function(){var t;switch(this.style){case"bars":t=new Bars(this.canvas,this.player);break;case"dots":t=new Dots(this.canvas,this.player);break;case"circle":t=new Circle(this.canvas,this.player)}return t.draw()},t.prototype.run=function(){return this.player.play(),this.draw()},t}(),this.Base=function(){function t(t,n,s,r){null==s&&(s="rgb(0, 0, 0)"),null==r&&(r="rgb(100, 50, 50)"),this.canvasCtx=t.getContext("2d"),this.background=s,this.foreground=r,this.WIDTH=t.width,this.HEIGHT=t.height,this.init(n)}return t.prototype.init=function(t){var n;return n=new(window.AudioContext||window.webkitAudioContext),this.analyser=n.createAnalyser(),this.analyser.fftSize=2048,this.analyser.connect(n.destination),this.source=n.createMediaElementSource(t),this.source.connect(this.analyser)},t.prototype.setBackground=function(){return this.canvasCtx.fillStyle=this.background,this.canvasCtx.fillRect(0,0,this.WIDTH,this.HEIGHT)},t.prototype.setAnimationFrame=function(){var t;return t=requestAnimationFrame(this.draw),this.bufferLength=this.analyser.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.analyser.getByteFrequencyData(this.dataArray)},t}(),this.Bars=function(t){function r(){return this.draw=n(this.draw,this),r.__super__.constructor.apply(this,arguments)}return s(r,t),r.prototype.draw=function(){var t,n,s,r,i,a,e;for(this.setAnimationFrame(),this.setBackground(),a=this.WIDTH/this.bufferLength*2.5,e=0,r=this.dataArray,i=[],n=0,s=r.length;s>n;n++)t=r[n],this.canvasCtx.fillStyle="rgb("+parseInt(t+100)+",50,50)",this.canvasCtx.fillRect(e,this.HEIGHT-t/2,a,t/2),i.push(e+=a+1);return i},r}(Base),this.Dots=function(t){function r(){return this.draw=n(this.draw,this),r.__super__.constructor.apply(this,arguments)}return s(r,t),r.prototype.draw=function(){var t,n,s,r,i,a,e;for(this.setAnimationFrame(),this.setBackground(),a=this.WIDTH/this.bufferLength*2.5,e=0,r=this.dataArray,i=[],n=0,s=r.length;s>n;n++)t=r[n],this.canvasCtx.strokeStyle="rgb("+parseInt(t+100)+",50,50)",this.canvasCtx.beginPath(),this.canvasCtx.arc(e,this.HEIGHT-t/2,a/4,0,2*Math.PI),this.canvasCtx.fillStyle="rgb("+parseInt(t+100)+",50,50)",this.canvasCtx.fill(),this.canvasCtx.stroke(),i.push(e+=a+1);return i},r}(Base),this.Circle=function(t){function r(){return this.draw=n(this.draw,this),r.__super__.constructor.apply(this,arguments)}return s(r,t),r.prototype.draw=function(){var t,n,s,r,i,a,e;for(this.setAnimationFrame(),this.setBackground(),a=this.WIDTH/this.bufferLength*2.5,e=0,r=this.dataArray,i=[],n=0,s=r.length;s>n;n++)t=r[n],this.canvasCtx.strokeStyle="rgb("+parseInt(t+100)+",50,50)",this.canvasCtx.beginPath(),this.canvasCtx.arc(this.WIDTH/2,this.HEIGHT/2,a*t,0,2*Math.PI),this.canvasCtx.fillStyle="rgb("+parseInt(t+100)+",50,50)",this.canvasCtx.fill(),this.canvasCtx.lineWidth=4,this.canvasCtx.strokeStyle="#ff6600",this.canvasCtx.stroke(),i.push(e+=a+1);return i},r}(Base)}).call(this);